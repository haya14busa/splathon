<section class="content-header">
  <h1>
    順位表
  </h1>
  <ol class="breadcrumb">
    <li><a href="#"><i class="fa fa-dashboard"></i> Level</a></li>
    <li class="active">Here</li>
  </ol>
</section>

<section class="content container-fluid">
  <div>
    <p id="notice"><%= notice %></p>

    <div>
      <%= form_tag event_qualifiers_path(@event), method: :post do %>
        <%= submit_tag '組み合わせ抽選', class: 'btn btn-default' %>
      <% end %>
    </div>

    <table class="table">
      <thead>
        <tr>
          <th>順位</th>
          <th>チーム名</th>
          <th>企業名</th>
          <th>勝ち点</th>
          <% Qualifier.where(event: @event).each do |q| %>
            <th>
              <%= link_to "#{q.round.ordinalize} ラウンド", matches_event_qualifier_path(id: q.id, event_id: @event.id) %>
            </th>
          <% end %>
        </tr>
      </thead>

      <tbody>
        <% @teams.each do |team| %>
          <tr>
            <td><%= team.rank %></td>
            <td><%= team.name %></td>
            <td><%= team.company_name %></td>
            <td><%= team.points %></td>
            <% Qualifier.where(event: @event).each do |q| %>
              <td>
                <% match = q.matches.select { |m| m.team == team }.first %>
                <div class="row">
                  <%= q.opponent(team).name %> : <%= match.points %>
                </div>

                <% if false %>
                <div class="row">

                  <%= form_tag win_match_path(match), method: :post, class: 'button' do %>
                    <%= button_tag type: :submit, class: 'btn-sm btn-success' do %>
                      <%= fa_icon 'smile-o' %>
                    <% end %>
                  <% end %>

                  <%= form_tag draw_match_path(match), method: :post, class: 'button' do %>
                    <%= button_tag type: :submit, class: 'btn-sm btn-secondary' do %>
                      <%= fa_icon 'meh-o' %>
                    <% end %>
                  <% end %>

                  <%= form_tag lose_match_path(match), method: :post, class: 'button' do %>
                    <%= button_tag type: :submit, class: 'btn-sm btn-danger' do %>
                      <%= fa_icon 'frown-o' %>
                    <% end %>
                  <% end %>
                </div>
                <% end %>
              </td>
            <% end %>
          </tr>
        <% end %>
      </tbody>
    </table>
  </div>
</section>
